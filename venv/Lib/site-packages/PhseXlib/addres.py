import re
from PhseXlib.locals import CONFIG
from sys import exit

# CONFIG = json.load(Path("build.json").open("r",encoding="utf-8"))
string = re.compile(r'"([^"\\]|\\.)*"')
number =  re.compile(r'[1-9]\d*')
flag = re.compile(r'^f:.*')

def addres_transformer(addres):
    REG_ADDR = re.compile(r"R[0-9]")
    RAM_ADDR = re.compile(r'0x[0-9a-fA-F]+')
    ADDR_ROUTE = {"file":"", "key":""}

    if re.fullmatch(REG_ADDR,addres):
        ADDR_ROUTE["file"] = CONFIG["REG_file"] # type: ignore
        ADDR_ROUTE["key"] = addres
    elif re.fullmatch(RAM_ADDR,addres):
        ADDR_ROUTE["file"] = CONFIG["RAM_file"] # type: ignore
        ADDR_ROUTE["key"] = addres
    elif re.fullmatch(string,addres):
        ADDR_ROUTE["file"] = "TYPE:STRING"
        ADDR_ROUTE["key"] = addres
    elif re.fullmatch(number,addres):
        ADDR_ROUTE["file"] = "TYPE:INT"
        ADDR_ROUTE["key"] = addres
    else:
        print(f"Arguments {addres} Error.")
        exit()
    return ADDR_ROUTE